Khartoum — The sound of gunfire echoed late into the night in Khartoum on Monday evening, as security forces clashed with demonstrators almost immediately after Sudan's ruling military council announced it had reached an agreement with protest leaders on a transitional authority. Firing tear gas and live bullets and beating protesters, armed men in uniform descended on barricades set up by protesters, witnesses said, killing several and wounding dozens. Sudan's ruling Transitional Military Council blamed "unidentified elements" for the attack and said one military police officer - an army major - was among the victims. But it was unclear who was responsible for the shooting. On Nile Street, protesters set up rows of consecutive roadblocks of stone and metal, burning tires and pressing north against their heavily armed adversaries. Meanwhile, soldiers on trucks mounted with machine guns patrolled among the protesters — creating confusion as to who the men in uniform are. Yassir Mohamed, a lawyer, spoke to VOA after fleeing gunfire on Nile Street just before midnight. "Unfortunately, I can't say who attacked us," he said. "But from what I've seen and experienced, it was [likely] shadow soldiers and National Security who caused this massacre." National Security Agency Sudan's notorious National Security agency is loyal to former President Omar al-Bashir, who was in power for 30 years until a military junta toppled him in April following months of street protests against his often dictatorial rule. Sudan's regular army has defended protesters who have camped out in a massive sit-in against previous attacks by Bashir loyalists - nearly all protesters say they support the army soldiers who have stood with them. But besides the army and National Security personnel, there are also military police and a heavily-armed Darfuri militia - the Rapid Support Forces - linked to ousted President al-Bashir. Many protesters also say there is a "shadow force" also loyal to Bashir. Adding to confusion is the belief among protesters that these various groups may be wearing each other's uniforms. The military took power after ousting al-Bashir on April 11 from three decades of rule. The coup followed four months of anti-government protests sparked by fuel and food shortages in which dozens were killed in clashes with security forces. Protesters have erected barricades and blocked roads around Sudan's Defense Ministry, where they have been ever since demanding the military hand power to civilians. They expanded their barricades in recent days as confrontation with security forces became more frequent. Those with gunshot wounds were taken to nearby hospitals. Others were treated on the street before being rushed to a field clinic set up by protesters, dozens of injured people streamed in as gunfire crackled outside. Medical workers struggled to make space for the incoming wounded in the makeshift hospital. Many of the injured people suffered from inhaling tear gas that security forces fired at protesters. Others had head wounds and say they were beaten with thick welts and scars along their backs from blows by sticks, whips, and rifle butts. One of them was Yusuf el-Sair, who said a member of the Rapid Support Forces — who was in uniform — beat him under the Blue Nile Bridge on Nile Street, a flashpoint for confrontation in recent days. "Gunfire is usually normal but, people started running, and Rapid Support Forces started coming under the bridge," he said. "I tried to hide since I have a disability and can't run, but an RSF soldier started beating me. I yelled, "I'm hurt! I'm hurt!", he said, but the soldier didn't listen and just kept beating." Guns for hire El-Sair accused the Rapid Support Forces of being an undisciplined militia. The RSF was created by al-Bashir to put down insurgencies in Darfur and other areas, and has also patrolled borders to stop migrants from heading toward Europe. The commander of the RSF is now the deputy head of the Transitional Military Council. "They are militias of gun for hire, there's no doubt," el-Sair said of the RSF. "Because anybody who would kill or hit people for money without reason is just a mercenary." Monday's violence came as a surprise as the ruling military council has been in talks with protest leaders for the past few weeks on forming an interim government. But the field clinic's Dr. Iman el Tijani said the situation appears to be escalating. "The first days of the sit-in there was a lot of violence to be honest from the forces, and then there was a stillness or calmness afterwards for almost a little bit less than a month," she said. "And now recently, especially today, there's been a relapse into the violence." Monday night's violence seemed timed to upset progress in talks between Sudan's military and protest leaders on a transitional authority. The attacks came just hours after the military council announced they had reached a deal. Sudan's prosecutor general's office had also declared former President Omar al-Bashir had been charged over the killings of protesters. As the night wore on, the body count rose. In one section of the sit-in, men carried the body of one person killed in the clashes, chanting songs and waving Sudanese flags as ambulance sirens whined nearby. The military council and protest leaders have said the violence will not stop them from forming a transitional government before holding elections. But with attacks on them increasing, protesters have to figure out which troops are with them and which are against them.